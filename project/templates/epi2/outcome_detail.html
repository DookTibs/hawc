{% extends 'portal.html' %}


{% block title %}
  {% include "hawc/siteTitle.html" with crumbs=object.get_crumbs crud=crud %}
{% endblock title %}

{% block breadcrumbs %}
  {% include "hawc/breadcrumbs.html" with crumbs=object.get_crumbs crud=crud %}
{% endblock %}

{% block content %}
    <h1>{{object.name}}
        {% if obj_perms.edit and crud == "Read" %}
          <div class="btn-group pull-right">
            <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Actions
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li class="disabled"><a tabindex="-1" href="#">Outcome editing</a></li>
                <li><a href="{% url 'epi2:outcome_update' object.pk %}">Update</a></li>
                <li><a href="{% url 'epi2:outcome_delete' pk=object.pk %}">Delete</a></li>
                <li class="disabled"><a tabindex="-1" href="#">Results</a></li>
                <li><a href="{% url 'epi2:result_create' object.pk %}">Create</a></li>
            </ul>
          </div>
        {% endif %}
    </h1>
{% endblock %}


{% block extrajs %}
  <script type="text/javascript">
    $.get("{% url 'epi2:api:outcome-detail' object.id %}", function(d){

        var content = $('#content');

        $('<pre>').html(JSON.stringify(d, null, '\t')).appendTo(content);

        $('<h2>Results</h2>').appendTo(content);

        $('<ul>').append(
            _.map(d.results, function(d){
              return "<li><a href='{0}'>{1}: {2}</a></li>".printf(d.url, d.groups.name, d.metric.metric);
            })
          ).appendTo(content);
    });
  </script>
{% endblock %}
