{% extends 'base_d3_only.html' %}


{% block title %}
  {{assessment}} | {{object.study}} | {{object}} | Time-Dose-Response Plot | HAWC
{% endblock title %}

{% block content %}
  <div class="row" style="padding:10px">
    <div class="span12">
      <div class="span5">
        <div id='tdr_plot' class="d3_container">
        </div>
      </div>
      <div class="span5">
        <div id='dr_plot' class="d3_container">
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block extrajs %}
  <script src="{{STATIC_URL}}animal/js/endpoint.js" type="text/javascript"></script>
  <script src="{{STATIC_URL}}animal/js/endpoint.ctplot.js" type="text/javascript"></script>
  <script type="text/javascript">
    var dummy_endpoint_data = JSON.parse('{"NOEL": -999, "name": "Liver lesions", "data_type": "C", "LOEL": 3, "study": "Example study 2013", "BMD": {"plotting": {"formula": "{a} * ({c}-({c}-1) *  Math.exp(-1.*Math.pow({b}*x,{d})))", "parameters": {"a": 9.98998, "c": 2.07535, "b": 0.0222227, "d": 1.82666, "sign": 1.0}}, "option_id": 3, "option_override": {"constant_variance": 0}, "id": 1032, "option_defaults": {"a": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "a"}, "c": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "c"}, "b": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "b"}, "d": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "d"}, "dose_drop": {"c": "ot", "t": "dd", "d": 0, "f": 0, "n": "Doses to drop"}, "parameter_conv": {"c": "op", "t": "d", "d": 1e-08, "f": 0, "n": "Parameter"}, "relative_fn_conv": {"c": "op", "t": "d", "d": 1e-08, "f": 0, "n": "Relative Function"}, "bmdl_curve_calc": {"c": "ot", "t": "b", "d": 0, "f": 0, "n": "BMDL Curve Calculation"}, "constant_variance": {"c": "ot", "t": "b", "d": 1, "f": 0, "n": "Constant Variance"}, "rho": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "Rho"}, "alpha": {"c": "p", "t": "p", "d": "d|", "f": 0, "n": "Alpha"}, "bmd_calculation": {"c": "ot", "t": "b", "d": 1, "f": 0, "n": "BMD Calculation"}, "max_iterations": {"c": "op", "t": "i", "d": 250, "f": 0, "n": "Iteration"}}, "option_override_text": ["Constant Variance = false"], "override_text": "Best-fitting model despite low global variance fitting.", "bmr_id": 0, "outputs": {"p_value2": "<0.0001", "p_value3": 0.8992, "p_value1": "<0.0001", "p_value4": 0.07929, "model_version": 1.7, "residual_of_interest": -0.2084, "fit_stdev": [1.0, 2.3, 4.7, 6.8, 9.11], "AIC": 370.8088, "parameters": {"a": {"estimate": 9.98998}, "c": {"estimate": 2.07535}, "b": {"estimate": 0.0222227}, "lnalpha": {"estimate": -13.076}, "rho": {"estimate": 5.67465}, "d": {"estimate": 1.82666}}, "Chi2": 3.079, "fit_est_stdev": [0.9924, 2.141, 4.898, 7.876, 7.877], "fit_residuals": [0.04516, -0.2084, 0.4232, -0.9832, 0.7195], "fit_size": [20.0, 20.0, 20.0, 20.0, 20.0], "warnings": [], "df": 1.0, "CSF": -999, "fit_estimated": [9.99, 13.1, 17.54, 20.73, 20.73], "fit_dose": [0.0, 25.0, 50.0, 150.0, 350.0], "fit_observed": [10.0, 13.0, 18.0, 19.0, 22.0], "BMD": 12.5409, "BMDL": 6.95302, "model_date": "12/10/2009", "model_name": "Exponential-M5", "BMDU": -999}, "override": 0, "bmds_plot_url": "http://127.0.0.1:8000/media/bmds_plot/egucdxcz.emf", "model_name": "Exponential-M5"}, "dataset_increasing": true, "url": "/ani/endpoint/36/", "response_units": "mg/hr", "study_url": "/study/7/", "pk": 36, "dr": [{"incidence": null, "n": 20, "dose_group_id": 0, "stdev": 1.0, "pk": 144, "dose": 0.0, "response": 10.0}, {"incidence": null, "n": 20, "dose_group_id": 1, "stdev": 2.3, "pk": 145, "dose": 25.0, "response": 13.0}, {"incidence": null, "n": 20, "dose_group_id": 2, "stdev": 4.7, "pk": 146, "dose": 50.0, "response": 18.0}, {"incidence": null, "n": 20, "dose_group_id": 3, "stdev": 6.8, "pk": 147, "dose": 150.0, "response": 19.0}, {"incidence": null, "n": 20, "dose_group_id": 4, "stdev": 9.11, "pk": 148, "dose": 350.0, "response": 22.0}], "numDG": 5, "dose_units": "mkd"}');
    var endpoint = new Endpoint(dummy_endpoint_data);
    var plot = new CTPlot(endpoint, '#tdr_plot');
  </script>
{% endblock %}
