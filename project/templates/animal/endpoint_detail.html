{% extends 'portal.html' %}


{% block title %}
  {{assessment}} | {{object.animal_group.experiment.study}} | {{object.animal_group.experiment}} | {{object.animal_group}} | {{object}} | HAWC
{% endblock title %}

{% block breadcrumbs %}
  <li><a href="{{ assessment.get_absolute_url }}">{{ assessment }}</a><span class="divider">/</span></li>
  <li><a href="{{ object.animal_group.experiment.study.get_absolute_url }}">{{object.animal_group.experiment.study}}</a><span class="divider">/</span></li>
  <li><a href="{{ object.animal_group.experiment.get_absolute_url }}">{{object.animal_group.experiment}}</a><span class="divider">/</span></li>
  <li><a href="{{ object.animal_group.get_absolute_url }}">{{object.animal_group}}</a><span class="divider">/</span></li>
  {% block breadcrumbs_self %}
    <li class="active">{{object}}<span class="divider">/</span></li>
  {% endblock breadcrumbs_self %}
{% endblock %}

{% block content %}

  <h1>{{object}}
    {% if crud == "Read" and obj_perms.edit %}
      <div class="btn-group pull-right">
        <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Actions <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li class="disabled"><a tabindex="-1" href="#">Endpoint Editing</a></li>
            <li><a href="{{ object.get_update_url }}">Update endpoint</a></li>
            <li><a href="{% url 'animal:endpoint_delete' object.pk %}">Delete endpoint</a></li>
        </ul>
      </div>
    {% endif %}
  </h1>

  <!-- Endpoint details -->
  <div class="row-fluid">
    <div id="dr-details" class="span7">
      <h2>Endpoint Details</h2>
      <div id="endpoint-details-table"></div>

      <h2>Dataset</h2>
      <table id="dr-tbl" class="table table-condensed table-striped"></table>
    </div>

    <div id='dr-plot-container' class="span5">
      <h2>Plot</h2>
      <div id='bmd_ds_plot' class="d3_container">
      </div>
    </div>
  </div>

  {% if crud == "Read" %}

    <!-- Comments -->
    <div id="comments_block"></div>

  {% endif %}

{% endblock %}

{% block extrajs %}
  {% if crud == "Read" %}
    {% include "comments/_comments_extrajs.html" %}
  {% endif %}
  <script type="text/javascript">
    var endpoint = new Endpoint({{object.d_response|safe}}),
        plot = new EndpointPlotContainer(endpoint, '#bmd_ds_plot');

    endpoint.build_details_table($('#endpoint-details-table'));
    endpoint.build_endpoint_table($('#dr-tbl'));
  </script>
{% endblock %}
